<launch>
    <arg name="rviz"       default="true" />
    <arg name="rtabmap_viz" default="false" />

    <include file="$(find s_map)/src/launch/static_publishers_heron.launch"/>
    <include file="$(find s_map)/src/launch/map_heron.launch"/>

    <node pkg="s_map" type="pc2_to_depth_image.py" name="pc2_to_depth_image"  output="screen">
        <param name="camera_info_topic" value="realsense/rgb/camera_info"/>
        <param name="rgb_topic" value="/realsense/rgb/image_raw"/>
    </node>

    <node pkg="s_map" type="detection.py" name="s_map_detection"  output="screen">
        <param name="camera_name" value="front"/>
        <param name="rgb_topic" value="realsense/rgb/image_raw"/>
        <param name="depth_topic" value="realsense/aligned_depth_to_color/image_raw"/>
        <!--param name="depth_topic" value="/processed_depth_image"/-->
        <param name="camera_info_topic" value="realsense/rgb/camera_info"/>
    </node>

    <node pkg="s_map" type="mapping.py" name="s_map_mapping"  output="screen">
        <param name="world_frame" value="map"/>
        <param name="camera_info_topic" value="realsense/rgb/camera_info"/>
    </node>

          <!-- Visualisation RTAB-Map -->
    <node if="$(arg rtabmap_viz)" pkg="rtabmap_viz" type="rtabmap_viz" name="rtabmap_viz" args="-d $(find rtabmap_demos)/launch/config/rgbd_gui.ini" output="screen">
      <param name="subscribe_rgbd"      type="bool" value="true"/>
      <param name="subscribe_laserScan" type="bool" value="true"/>
      <param name="frame_id"            type="string" value="mir/base_link"/>

      <remap from="scan"            to="/scan"/>
      <remap from="odom" to="/scanmatch_odom"/>
      <param name="subscribe_odom_info" type="bool" value="true"/>
    </node>

    <node if="$(arg rviz)" pkg="rviz" type="rviz" name="rviz" args="-d $(find s_map)/rviz/heron_config.rviz"/>

</launch>